# 場合の数

## Q1 個数定理

??? success

    ### 場合の数分野について

    ```text
    導出の仮定は、式変形のみでなく、日本語で残すようにする
    ```

    ### 2つの集合の和集合の要素の個数

    ```text
    ※集合Aの要素の個数をn(A)と表す

    n(A∪B) = n(A) + n(B) - n(A∩B)
    特にA∩B = ∅の時、n(A∪B) = n(A) + n(B)

    ※n(A)の要素の個数, n(B)の要素の個数をそれぞれa,b
      n(A∩B)の要素の個数をcとする

      a + bを考えると、c部分を重複して数えているため
      a + b - cとすることで、n(A∪B)の領域の要素の個数となる

      A∩B = ∅の場合、重複部分は存在しないため、単にa+bで問題ない
    ```

    ### 補集合の要素の個数

    ```text
    n(A^C) = n(U) - n(A)

    全体集合の要素の個数から、その部分集合Aの要素の個数を引くと
    集合Aの補集合の要素の個数になる

    ※補集合の定義が、ある集合Aが全体集合の部分集合であり
      集合Aを全体集合から引いたときの集合であるため、定義より分かる
    ```

    ### 3つの集合の和集合の要素の個数

    ```text
    n(A∪B∪C) = n(A) + n(B) + n(C) - n(A∩B) - n(B∩C) - n(C∩A) + n(A∩B∩C)

    同様に、重複分を引く。3つの集合の共通部分が消失するため、最後に付け加える
    ```

    ### 例

    ```text
    100~200までの整数のうち、次の整数の個数を求めよ
    全体集合をU, 3の倍数全体の集合をA, 5の倍数全体の集合をBとすると

    n(U) = 200 - 100 + 1 = 101
    A = {3*34, ..., 3*66} n(A) = 66 - 34 + 1 = 33
    B = {5*20, ..., 5*40} n(B) = 40 - 20 + 1 = 21
    A∩B = {15*7, ..., 15*13} n(A∩B) = 13 - 7 + 1 = 7
    --> 倍数の個数を表現する際は、積の形で要素を抜き出すといい

    99 / 3 = 33, 200 / 3 = 66より、66 - 33 = 33としてもいいけれど 


    [1] 3の倍数 ∧ 5の倍数
    n(A∩B) = 7

    [2] 3の倍数 ∨ 5の倍数

    n(A∪B) = n(A) + n(B) - n(A∩B) = 33 + 21 - 7 = 47

    [3] (3の倍数 ∧ ￢5の倍数) ⇔ ￢(3の倍数 ⇒ 5の倍数)
    3の倍数 5の倍数
    ×       〇　--> False
    ×       ×  --> False
    〇      ×   --> True
    〇       〇  --> False
    全体集合U - n(A^C) - n(A∩B) ⇔ n(A) - n(A∩B)
    --> 3の倍数から、3の倍数と5の倍数の共通部を引いた数に等しい

    n(A ∩ ^B) = n(A) - n(A ∩ B)
    = 33 - 7 = 26

    [4] ￢3の倍数 ∧ ￢5の倍数 ⇔ ￢(3の倍数 ∨ 5の倍数)
    
    n({A∪B}^C) = n(U) - n(A∪B) = 101 - 47 = 54 
    ```

    ### 例2

    ```text
    全体集合をU, A,B,CをUの部分集合とする

    n(U) = 160
    n(A) = 70
    n(B) = 50
    n(C) = 60
    n(A∩B) = 20
    n(B∩C) = 13
    n(C∩A) = 15
    n(A^c ∩ B^c ∩ C^c) = 23の時、

    n(A ∩ B^c ∩ C^c)を求めよ

    A^c ∩ B^c ∩ C^c ⇔ (A∪B∪C)^c 
    n(A∪B∪C) = 160 - 23 = 137

    個数定理より
    n(A∪B∪C) = n(A) + n(B) + n(C) - n(A∩B) - n(B∩C) - n(C∩A) + n(A∩B∩C)
    137 = 70 + 50 + 60 - 20 - 13 - 15 + n(A∩B∩C)
    137 = 132 + n(A∩B∩C)
    n(A∩B∩C) = 5

    ※ベン図に埋めれば
    n(A ∩ B^c ∩ C^c) = 70 - (15 + 5 + 10) = 40とわかる

    --------------------------------
    [別解]
    集合Aのうち、B,Cとの共通部分がない分であるとわかるので
    n(A ∩ B^c ∩ C^c) = n(A∪B∪C) - n(B∪C)

    n(A∪B∪C)＝137
    n(B∪C) = n(B) + n(C) - n(B∩C) = 50 + 60 - 13 = 97
    137 - 97 = 40

    ※各部分を文字でおき、連立方程式を解いてもいける
    ```

    ![ベン図を用いた解法](./images/081.png)

## Q2 集合の要素の個数の最大、最小

??? success

    ### 例

    ```text
    集合Uと、その部分集合A,Bに対し、n(U) = 100, n(A) = 70, n(B) = 40とする

    [1] n(A∩B) の最大値と最小値を求めよ

    n(A∪B) = n(A) + n(B) - n(A∩B)より
    n(A∩B) = n(A) + n(B) -  n(A∪B)

    つまり、
    n(A∪B)が最小値 ⇒ n(A∩B)は最大値
    n(A∪B)が最大値 ⇒ n(A∩B)は最小値

    n(A) > n(B)であるため
    n(A∪B)が最小値をとる時とは、BがAの部分集合であるときになる
    この時、n(A∪B) = 70
    ∴　n(A∩B)の最大値は、70 + 40 - 70 = 40

    n(A∪B)の最大値は, 全体集合の個数と同一の100である。
    ∴ n(A∩B)の最小値は、110 -100  = 10

    ※n(A∪B)が最大をとるとき、n({A∪B}^c)は最小をとる
    n(A) + n(B) > n(U)より、n({A∪B}^c)の最小値は0
    n(A∪B)の最大値は、n(U) - 0 = 100 

    [2] n(A∩B^c)の最大値と最小値を求めよ

    n(A∩B^c) = n(A) - n(A∩B)より、
    n(A∩B)が最小値をとる時、n(A∩B^c)は最大値をとる
    ∴ n(A∩B^c)の最大値は、70 - 10 = 60

    同様に考えて
    ∴ n(A∩B^c)の最小値は、70 - 40 = 30
    ```

## Q3 和の法則と積の法則

??? success

    ### 数え方

    ```text
    漏れなく重複なく数え上げるやり方を採用する
    ```

    ### 和の法則

    ```text
    2つの事柄A,Bがあり、Aがm通り, Bがn通りとする
    この時、A,Bが同時には起こらないとすると
    |A∨B| = m + n通り

    n(A∧B) = 0の時を表しているに過ぎない
    ```

    ### 排反

    ```text
    A∧Bが空集合であるとき、AとBは互いに排反であるという

    排反であるように場合分けを行えば、
    最後に足すだけで済むが、共通部分が存在すると足し引きする必要が生じる
    ⇒排反になるように場合分けを行う
    ```

    ### 例

    ```text
    AとBの2人が対戦し、先に3回勝った方を優勝とする
    最終的にAが優勝する時、優勝が決まるまでの決め方は何通り存在するか

    1回目にAが勝つ∧ 1回目にBが勝つは同時には起こらない。よって
    この事象は互いに排反

    2回目以降も同様

    Bが3回勝った場合、Bが優勝してしまうため
    Bは2回までしか勝てないことに注意する。

    辞書式配列の形で書きだすと
    AAA
    AABA
    AABBA
    ABAA
    ABABA
    ABBAA

    BAAA
    BAABA
    BABAA
    BBAAA

    よって、10通り

    ------------------

    [別解]

    [i] Aが3回勝ち、Bが0回勝つ
    [ii] Aが2回勝ち、Bが1回勝つ. その後Aが勝つ
    [iii] Aが2回勝ち、Bが2回勝つ. その後Aが勝つ　
    という事象に分解できる。またそれぞれの事象は互いに排反である

    [i]
    nCk(n:Aが勝った回数, k:試行回数)とすると
    3C3 = 1通り

    [ii]
    3C2 = 3通り

    [iii]
    4C2 = 6通り

    [i]~[iii]より、1 + 3 + 6 = 10通り
    ```

    ### 積の法則

    ```text
    Aがm通り生じ、そのいずれの場合に対しても、Bがn通り生じる
    この時、AとBがともに生じる場合の数はm*n通り

    --> 樹形図で考えた場合、均等に枝分かれするため
        書き出す必要なく判断可能
    ```

    ### 例

    ```text
    [1] 硬貨を3回投げるとき、表裏の出方は何通りあるか

    A,B,Cを硬貨を投げる事象であると考える
    A,B,Cがともに生じる場合の数は2^3 = 8通り

    ---------------------------

    [2] 大小2個のサイコロを投げるとき出た目の和が偶数になる場合の数は何通りあるか

    ※二つのサイコロは区別される。
    大きいサイコロの目の集合をA, 小さいサイコロの目の集合をBとする。
    A = {1,2,3,4,5,6}, B = {1,2,3,4,5,6}

    和が偶数となるのは、
    Aの出目(奇数) + Bの出目(奇数) = (偶数)
    Aの出目(偶数) + Bの出目(偶数) = (偶数)の場合であり、この事象は互いに排反である

    [i] Aの出目が奇数で、Bの出目が奇数になる場合の数は
    {(a,b) | a∊{1,3,5}, b∊{1,3,5}}の要素数に等しい
    よって、積の法則より3*3 = 9通り

    [ii] Aの出目が偶数で、Bの出目が偶数になる場合の数は
    {(a,b) | a∊{2,4,6}, b∊{2,4,6}}の要素数に等しい
    よって、積の法則より3*3 = 9通り

    [i],[ii]より、18通り

    ```

## Q4 補集合を利用するケース

??? success

    ### 考え方

    ```text
    (Aである) = (全体) - (Aでない)
    (Aでない) = (全体) - (Aである)
    (少なくとも1つはA) = (全体) - (すべてAでない)
    ```

    ### 例

    ```text
    [1] 大小2個のサイコロを投げる. 目の和が10以下になる場合は何通りあるか

    サイコロは区別される。
    (目の和が10以下になる場合) = (全体) - (目の和が11以上になる場合)なので
    目の和が11≧になる場合を考えると
    (5,6),(6,5),(6,6)の3通りであるとわかる
    サイコロが区別された時の出目の総組み合わせは6*6 = 36通りなので、
    ∴ 36 - 3 = 33通り

    [2] 大中小3個のサイコロを投げるとき、目の積が偶数になる場合は何通りあるか

    サイコロは区別される
    (目の積が偶数になる場合) = (全体) - (目の積が奇数になる場合)であるため
    目の積が奇数になる場合を考えると
    Aの出目(奇数) * Bの出目(奇数) * Cの出目(奇数)の場合とわかる

    つまり、目の積が偶数になる場合とは、少なくとも1つの目が偶数になる場合と考えられる
    (目の積が偶数になる場合) = (全体) - (Aの目が奇数 ∧ Bの目が奇数 ∧ Cの目が奇数)

    この組み合わせの数を考えると
    n({1,3,5})*n({1,3,5})*n({1,3,5}) = 3^3 = 27通り
    3つのサイコロが区別された時の出目の総組み合わせは 6^3 = 216通りなので
    ∴ 216 - 27 = 189通り

    [3] 大中小3個のサイコロを投げるとき、目の積が4の倍数になる場合は何通りあるか

    サイコロは区別される。
    目の積が4の倍数になる場合を考えると

    [i] 3つのサイコロの出目がすべて偶数
    [ii] 2つのサイコロの出目が偶数で、1つのサイコロの出目が奇数
    [iii] 1つのサイコロの出目が4の倍数で、2つのサイコロの出目が奇数

    上記の3ケースに場合分けできる。また[i],[ii],[iii]は互いに排反である
    ため和の法則を用いることが可能

    [i] n({2,4,6}) = 3より、3*3*3 = 27通り
    [ii] 
      奇数となるサイコロを選ぶ事象を考えると3通り。よって
      3*( n({1,3,5}) * n({2,4,6}) * (n{2,4,6}) ) = 81通り

    [iii]
      出目が4であるサイコロを選ぶ場合の数は3通り。よって

      3*(n({1,3,5}) * n({1,3,5})) = 27通り

    [i],[ii],[iii]より
    27 + 81 + 27 = 135通り 
    ```

## Q5 硬貨で支払える金額の場合の数(両替)

??? success

    ### 例

    ```text
    以下の硬貨の全部、または一部を用いて支払える金額は何通り存在するか

    [1] 100円硬貨が4枚, 50円硬貨が1枚, 10円硬貨が3枚

    100円硬貨の使い方は 0~4枚で、5通り
    50円硬貨の使い方は 0~1枚で、2通り
    10円硬貨の使い方は 0~3枚で、4通り

    0円の場合は、一部を用いてという条件に反するため

    積の法則を用いて
    5*2*4 - 1 = 39通り

    [2] 100円硬貨が1枚, 50円硬貨が3枚, 10円硬貨が2枚

    100円硬貨の使い方は 0~1枚で、2通り
    50円硬貨の使い方は 0~3枚で、4通り
    10円硬貨の使い方は 0~2枚で、3通り

    大きい硬貨を小さい硬貨に両替して考えると
    50円硬貨の使い方は 0~5枚で、6通り
    10円硬貨の使い方は 0~2枚で、3通り

    積の法則を用いて
    6 * 3 - 1 = 17通り

    [3] 100円硬貨が2枚, 50円硬貨が1枚, 10円硬貨が7枚

    100円硬貨の使い方は 0~2枚で、3通り
    50円硬貨の使い方は 0~1枚で、2通り
    10円硬貨の使い方は 0~7枚で、8通り

    大きい硬貨を小さい硬貨に両替して考えると

    10円硬貨の使い方は 0~32枚で、33通り
    よって、33 - 1 = 32通り
    ```

    ### 異なる硬貨で同一の金額を作れるときに、小さい硬貨に両替してよいわけ

    ```text
    支払い方の総組み合わせではなく、
    金額の場合の数が求められているので

    同一の金額となる場合
    例えば、50円硬貨1枚と、10円硬貨5枚の支払い方法があったとして、これは1通りである

    ここで、
    100円硬貨なら、100円刻みで
    50円硬貨なら、50円刻みで
    10円硬貨なら、10円刻みで支払えることに着目する。

    例えば50円硬貨1枚,10円硬貨7枚である時
    10円~120円までを10円刻みで支払うことができる
    これは、10円硬貨12枚に両替しても同様である
    
    一方、50円硬貨2枚,10円硬貨2枚とすると
    30円,40円, 80円, 90円を支払えなくなる

    ------------------------

    異なる貨幣で同一の金額を表せないときは両替してはいけない

    1円硬貨を3枚, 5円硬貨を2枚, 10円硬貨を2枚使って
    表すことのできる金額の場合の数を示せ

    1円硬貨を3枚, 5円硬貨を6枚と考えられる
    この時、例えば4円はどうしても示せないので、5円硬貨を1円硬貨5枚と考えてはいけない
    (3+1) * (6+1) - 1 = 27通り
    ```

## Q6 硬貨で支払う方法の場合の数

??? success

    ### 例

    ```text
    [1] 
    500円硬貨、100円硬貨,50円硬貨を用いて800円支払う方法の場合の数を求めよ
    支払わない硬貨があってもよい

    500,100,50円硬貨の使用枚数をそれぞれx,y,zとおく
    この時、(x,y,z≧ 0)

    500x + 100y + 50z = 800の両辺を1/50して
    10x + 2y + z = 16

    x = 1の時、
    2y + z = 6
    (y,z) = (3,0),(2,2),(1,4),(0,6)

    x = 0の時
    2y + z = 16
    (y,z) = (8,0),(7,2),(6,4),(5,6),(4,8),(3,10),(2,12),(1,14),(0,16)

    よって、13通り
    ※係数が大きい方の文字から値を絞り込むことで解ける

    --------------------------

    [2] 500,100,50円硬貨をそれぞれ1枚以上用いて、1000円支払う方法

    500x + 100y + 50z = 1000 (x,y,z ≧ 1)より
    両辺を1/50して

    10x + 2y + z = 20

    x = 2の時、(y,z) = (0,0)より不適
    x = 1の時、
    2y + z = 10
    (y,z) = (4,2), (3,4),(2,6),(1,8)より4通り

    ∴4通り

    ------------------

    [3] 500,100,50円硬貨を用いて、10000円支払う方法の場合の数
        使わない硬貨があってもよい

    同様に500x + 100y + 50z = 10000 (x,y,z ≧ 0)
    1/50倍して10x + 2y + z = 200とできるが、数が大きくなることに注意する

    係数が大きい順から絞り込むと
    xは0 ~ 20の値をとりうる
    x = kと置いたとき、(y,z)の組数を考えると

    x = k = 0の時、(y,z) = (100,0), (99, 2), ..., (0, 200)より、101組
    x = k = 1の時、(y,z) = (95, 0), ..., (0, 190)より、96組
    同様に考えて
    x = k = 19の時、(y,z) = (5, 0),...(0,10)より、6組
    x = k = 20の時、(y,z) = (0,0)より1組

    よって、x = kの時、(y,z)は101 - 5k組存在するとわかる
    等差数列の公式を用いると、(知らないなら足し合わせればいい　Σ_{k=0}^{20} 101 - 5k)

    初項101, 項数21, 末項1なので
    (1/2)21*(101 + 1) = 51 * 21 = 1071通り
    ```

    ### [2]の別解

    ```text
    [2] 500,100,50円硬貨をそれぞれ1枚以上用いて、1000円支払う方法

    各硬貨を1枚以上使うことを考えるとこの時点で
    500 + 100 + 50 = 650円

    つまり、残り350円の支払い方法(使わない硬貨が存在してもOK)という問いに帰着する
    また500円を用いて、350円を支払うことはできないため500円は1枚で確定
    50円は100円硬貨では支払えないので、50円硬貨2枚以上は確定する。

    よって、700円の支払い方は
    500円:1枚, 100円:1枚, 50円2枚で共通

    100円硬貨, 50円硬貨を用いた
    残り300円の支払い方法(使わない硬貨が存在してもOK)について場合の数を考えると
    (100円硬貨の枚数, 50円硬貨の枚数) = (3,0),(2,2),(1,4),(0,6)より4通り

    ∴ 4通り
    ```

## Q7 順列の基本(積の法則, nPr, 階乗)

??? success

    ### 順列

    ```text
    異なるn個のものからr個を取り出して1列に並べる順列の場合の数を
    nPrと表現すると、
    nPr = n(n-1)(n-2)...(n-r+1) = n! / (n-r)! (r≦n)である

    ただし、nPn = n(n-1)(n-2)...3*2*1 = n!と定める
    また、nP0 = 1, 0! = 1と定める。
    --------------------------

    [導出]
    1つ目の選び方がm通り
    それぞれについて,2つ目の選び方がm-1通り
    ...
    それぞれについて,r個目の選び方がm-r+1通りであることを考えると
    積の法則より総数は、
    n(n-1)(n-2)...(n-r+1)と表せる

    ここで、n! = n(n-1)...(n-r+1)(n-r)...3*2*1と表せる
    また、(n-r)! = (n-r)(n-r-1)...3*2*1である
    ∴ n! / (n-r)! = n(n-1)(n-2)...(n-r+1)

    異なるn個の中からn個を上回る数を取り出すことはできないため
    r ≦ nという制約も必要になる
    ```

    ### 例

    ```text    
    [1] 7人から3人選んで1列に並べるときの並び方の総数を求めよ

    7! / (7-3)! =  7*6*5 = 210通り

    [2] 7人全員を1列に並べるときの並び方の総数を求めよ

    7!/(7-7)! = 7! = 210*24 = 5040通り

    [3] 10人から校長、教頭、担任を1人ずつ決める場合の数(兼任不可)

    (1つ目の役職)は10通り
    それぞれについて、(2つ目の役職)が9通りで決まる
    それぞれについて、(3つ目の役職)が8通りで決まる

    ∴ 10*9*8 = 720通り

    [4] 3人の生徒がA,B,C,D,E,F席のいずれかに座る時の場合の数

    6席から3つの席を選び、3人の生徒に対応させると考えられる
    (1人目に対応する席) : 6通り
    (2人目に対応する席) : 5通り
    (3人目に対応する席) : 4通り
    よって、6P3 = 6*5*4 = 120通り

    [5] A,B,C,Dと書かれた玉を8人に配る(1人1個)時の場合の数
    
    8人から4人を選び、4つの玉に対応させる
    (1つ目の玉に対応する人物): 8通り
    (2つ目の玉に対応する人物) : 7通り
    (3つ目の玉に対応する人物) : 6通り
    (4つ目の玉に対応する人物) : 5通り
    --> 実際に樹形図で考えると均等であることがわかる
    4つの玉は区別できるため、順序が関係する

    よって、8P4 = 8*7*6*5 = 1680通り

    ```

    ### nPrの意味合い

    ```text
    異なるn個のものからr個を選び、他の異なるr個のものと1対1で対応させる場合
    {1,2,...,n}からr個選び、[1][2]...[r]に1対1で対応させる (r≦n)

    [1]への入れ方はn通り
    [2]への入れ方はn-1通り
    [r]への入れ方はn-r+1通り

    ---------------

    上記の問題を言い換えてみる

    [1] 10人から3人選んで、異なる3つの役職と1対1対応させるときの場合の数
    [2] 6席から3席選んで、3人と1対1対応させるときの場合の数
    [3] 8人から4人選んで、異なる4個の玉と1対1対応させるときの場合の数

    4人から3人選んで、A,B,Cに対応させる場合
    1つ目の選び方は4通り
    それぞれについて、2つ目の選び方は3通り
    それぞれについて、3つ目の選び方は2通り

    積の法則とは、独立した選択肢の数を掛け合わせることで
    全体の組み合わせの数を求める法則であるため

    ----------------------

    仮に、A --> B --> Cという順番で決めたとしても、
    B --> C --> Aという順番で決めたとしても問題はない。
    --> 選ぶ順番ごとに別々に数えると、(実際の場合の数)*(選択順)になってしまう

    実際、Bで1を選び、Cで2を選ぶとする。    
    この事象は、Aで{3,4}のうちいずれかを選んだ場合に含まれるため、
    例えば、A --> B --> Cという順で決めた場合と、
    B --> C --> Aという順で決めた場合の数を足す必要性はない
    ```

    ### 例2

    ```text
    男子5人と、女子2人を1列に並べる。次の並び方は何通りあるか

    [1] 少なくとも一方の端に女子が並ぶ

    (全体) - (両方の端に男子が並ぶ) = (少なくとも一方の端に女子が並ぶ)となる

    全体の並び方の総数を求める場合、これは7人を、7箇所に1対1対応させる総数に等しいので
    7! = 5040通り

    両方の端に男子が並ぶ場合
    男子5人の中から2人を選び、2か所に1対1対応させるので、5P2 = 20
    両端の並び20通りについてそれぞれ、
    残り5人の中から5人を選び、5か所に1対1対応させるので、
    
    5! = 120より
    (両方の端に男子が並ぶ) = 20*120 = 2400

    ∴ 5040 - 2400 = 2640通り

    [2] 左から奇数番目に男子が並ぶ

    (1:男子)(2)(3:男子)(4)(5:男子)(6)(7:男子)

    1の選び方は5P1
    3の選び方は4P1
    5の選び方は3P1
    7の選び方は2P1　--> 5P4
    残り3箇所の選び方は3P3

    ∴ 5*4*3*2*6 = 720通り
    ```

    ### 例3

    ```text
    7個の数字1,1,2,2,3,3,4がある
    左右どちらから読んでも同じ順番になるように並べるときの
    場合の数は何通りあるか

    条件より、4は列の真ん中(4)番目に来る
    また、4の左側に、1,2,3と並べた場合、右側には3,2,1と並ぶことになるように
    右側の並び順は、左側の並び順によって自動的に定まるため
    この問題は左側の並び順の総数に帰着する

    よって、3P3 = 6通り
    ```

## Q8 異なる数字の順列とその和

??? success

    ### 数字の順列の総数

    ```text
    ・条件の強い位から順に処理するといい
    ・最高位に0が来ると桁数が減ることに注意すること
    ```

    ### 倍数条件

    ```text
    2の倍数: 下1桁が2の倍数
    3の倍数：各位の数の和が3の倍数
    4の倍数: 下2桁が4の倍数
    6の倍数: 2の倍数 ∧ 3の倍数
    9の倍数: 各位の数の和が9の倍数
    ```

    ### 証明(5桁の場合)

    ```text
    10進数でabcdeと表せる数字Aは

    A = 10000a + 1000b + 100c + 10d + eと表せる
    
    [2の倍数]
    A = 2(5000a + 500b + 50c + 5d) + eより、
    eが偶数であれば、2の倍数。

    [3の倍数]
    A = 3(3333a + 333b + 33c + 3d) + a + b + c + d + e
    より、各位の数の和が3の倍数 ⇒ 3の倍数

    [4の倍数]

    A = 4(2500a + 250b + 25d) +10d + eより、
    下2桁が4の倍数 ⇒ 4の倍数

    [5の倍数]
    A = 5(2000a + 200b + 20c + 2d) + e
    下1桁が5の倍数 ⇒ 5の倍数

    [6の倍数]
    6は素数の積で表せる。よって、合成数
    つまり、6の倍数である ⇔ 2∧3で割り切れるので、これが倍数条件

    [8の倍数]
    A = 8(1250a + 125b) + 100c + 10d + e
    下三桁が8の倍数か判定すればいい

    [9の倍数]
    A = 9(1111a + 111b + 11c + d) + a + b + c + d + e
    各位の数の和が9の倍数 ⇒ 9の倍数

    [10の倍数]
    A = 10(1000a + 100b + 10c + d) + e
    下1桁が10の倍数 ⇒ 0 ⇒ 10の倍数

    [11の倍数]
    A = 11(909a + 91b + 9c + d) + a - b + c - d + e
    各位をそれぞれa,b,c,d,eとしたとき
    a - b + c - d + eが11の倍数となればよい

    ※7の倍数の場合、綺麗な形にならないので面倒
    ```

    ### 例

    ```text
    0,1,2,3,4,5から異なる4個を選んで4桁の整数を作る。
    この時、次の条件を満たす整数は何個できるか

    [1] 整数
    4個を選んで、4桁の整数を作る必要があることに注意する
    つまり4桁目は{1,2,3,4,5}の中から選ぶ必要がある

    4桁目は5P1
    それぞれについて、3,2,1桁目は 5P3
    よって、4P1 * 4P3 = 5*5*4*3 = 300個

    ※制限が強いので4桁目から処理した
      弱い方から処理すると、場合分けが生じて面倒になる
      たとえば、2桁目に0が出た場合....等

    [2] 奇数

    奇数であるとき、下1桁は{1,3,5}である。よって3通り
    4桁目は0以外の数である. よって、4通り
    残りの位は4個の数から2個を選んで1対1対応させる順列

    よって、3*4*4P2 = 12*12 = 144個

    [3] 偶数

    偶数であるとき、下1桁は{0,2,4}
    下1桁が{2,4}であるとき、
    4桁目は0以外の数である。つまり、4通り
    残りの位は4P2で求められる。よって、2*4*12 = 96通り

    下1桁が{0}であるとき
    残りの位は5P3で求められる。よって、60個
    ∴ 72 + 60 = 156個

    ※条件を同時に考慮できないときは、排反な事象に場合分けして考える。

    [4] 3の倍数

    各位の数の和が3の倍数である必要がある
    6個の中から4個の数を選ぶ組み合わせは6C4 = 15通りで求められるので
    (a,b,c,d | a<b<c<d) 
    = (0,1,2,3), (0,1,2,4), (0,1,2,5)
    (0,1,3,4), (0,1,3,5), (0,1,4,5)
    (0,2,3,4), (0,2,3,5), (0,2,4,5),
    (0,3,4,5),(1,2,3,4), (1,2,3,5),
    (1,2,4,5),(1,3,4,5), (2,3,4,5)

    の中から和が3の倍数になる組を探すと
    (0,1,2,3), (0,1,3,5), (0,2,3,4), (0,3,4,5), (1,2,4,5)となる

    (0,1,2,3), (0,1,3,5), (0,2,3,4), (0,3,4,5)の時、
    4桁目の選び方は3通り, 残りの位の選び方は3P3より、
    3*3P3 = 18通り. これが4組なので72個

    (1,2,4,5)の時、位の選び方は4P4 = 24個
    ∴ 72 + 24 = 96個

    [5] 6の倍数
    3の倍数 ∧ 2の倍数である必要がある

    和が3の倍数になる組は
    (0,1,2,3), (0,1,3,5), (0,2,3,4), (0,3,4,5), (1,2,4,5)であった

    (0,1,2,3)の時、
    下1桁が偶数になる数の選び方は(0,2)の2通り
    下1桁が0の時、残りの位の選び方は3P3 = 6通り
    下1桁が2の時、残りの位の選び方は2*2P2 = 4通り
    よって、合わせて10通り

    (0,1,3,5)の時、下1桁が0
    残りの桁の選び方は3P3 = 6通り

    (0,2,3,4)の時、
    下1桁が偶数になる数の選び方は(0,2,4)の3通り
    下1桁が0の時、3P3 = 6通り
    下1桁が0以外の時、2*2*2P2 = 8通り
    合わせて14通り

    (0,3,4,5)の時、(0,1,2,3)と同様に考えて10通り
    (1,2,4,5)の時、
    下1桁が偶数になる数の選び方は(2,4)の2通り
    残りの位の選び方は3P3
    よって、選び方は2*3P3 = 12

    ∴　10 + 6 + 14 + 10 + 12 = 52個

    [6] 4の倍数
    下2桁が4の倍数になる組み合わせを考えると

    (04, 12, 20, 24, 32, 40, 52)となる

    (04, 20, 40)の時残りの位の選び方は4P2
    よって、3*4P2 = 36個

    (12, 24, 32, 52)の時4桁目の選び方は3通り
    それぞれについて3桁目の選び方は3通り
    よって、4*3*3 = 36個

    ∴ 36 + 36 = 72個

    [7] 4の倍数 ∨ 5の倍数
    4の倍数でなく、5の倍数である下2桁の組み合わせを考えると
    (05, 10, 15, 25, 30, 35, 45, 50)

    (05, 10, 30, 50)の時残りの位の選び方は 4P2
    よって、4*4P2 = 48個

    (15, 25, 35, 45)の時4桁目の選び方は3通り
    それぞれについて3桁目の選び方は3通り
    よって、4*3*3 = 36個
    
    ∴ 48 + 36 + 72 = 156個

    --> 普通に4の倍数の個数と、5の倍数の個数を考えて、20の倍数の個数を引いてもいい

    [8] 3200より大きい整数

    4桁目が(4 or 5)の場合、残りの位の選び方は5P3
    よって、2*5P3 = 2*5*4*3 = 120個

    4桁目が3の場合 ∧　3桁目が(2,4,5)の場合
    残りの位の選び方は4P2
    よって、3*4P2 = 36個
    
    ∴ 120 + 36 = 156個
    ```

    ### [4]別解

    ```text
    0,1,2,3,4,5から異なる4個を選んで4桁の整数を作る。
    この時、次の条件を満たす整数は何個できるか

    [4] 3の倍数

    順序に関係のない条件がある時、組み合わせを書きだしてから、順列の総数を
    関の法則で求めるという方針は同一

    和が3の倍数 ⇔ 3で割ったときの余りの和が3の倍数
    余りは0,1,2しか存在しないので、
    これらの和が3の倍数となる組み合わせを考えると

    和が0は(0,0,0,0), 
    和が3は(0,0,1,2), (0,1,1,1), 
    和が6は(0,2,2,2),(1,1,2,2)  

    ここで、{0,1,2,3,4,5}の中から選ぶことから、
    3で割ったときの余りが同数になる数は2数ずつしか存在しない。
    よって、組み合わせは(0,0,1,2), (1,1,2,2)となる

    余りが(0,0,1,2)となる組は
    (0,3,1,2),(0,3,1,5), (0,3,4,2), (0,3,4,5)
    余りが(1,1,2,2)となる組は
    (1,4,2,5)

    よって、
    (0,3,1,2),(0,3,1,5), (0,3,4,2), (0,3,4,5)の時
    それぞれの組み合わせに対し、
    4桁目の選び方は3通りで、その他の桁の選び方は3P3なので
    4*3*3P3 = 72個

    (1,4,2,5)の時、4P4 = 24個
    ∴ 72 + 24 = 96個
    ```

    ### 例2

    ```text
    6個の数字0,1,2,3,4,5から異なる4個を選んでできるすべての4桁の整数の和を求めよ

    4桁の整数は全部で5*5P3 = 300個

    このうち、4桁目が1,2,3,4,5である整数はそれぞれ
    5P3 = 60個存在する。

    つまり、千の位の数の和は(1 + 2 + 3 + 4 + 5)*60 = 900

    4桁目が1であるとき、3桁目が0,2,3,4,5である整数はそれぞれ4P2 = 12個存在する
    2,3,4,5であるときも、同様に考えると
    百の位の数の和は、(1 + 2 + 3 + 4 + 5)*(5-1)*12 = 720

    十の位、一の位も同様に重複が不可能であることから
    (1,2,3,4,5)はそれぞれ48回ずつ登場するため
    数の和はそれぞれ720

    ∴ 900 * 1000 + 720 * 100 + 720 * 10 + 720  = 979920

    ----------------------------

    百の位について、それぞれの数の出現回数が
    4*4P2 = 48回になるわけを考える

    千の位で、0,該当の数以外を選び
    百の位で、該当の数を選び
    残りの位で、4つの数と、2つの位を1対1対応させる事象の総数を考えると
    4 * 1 * 4P2 = 48となる

    千の位で、0,該当の数以外を選び、百の位で該当の数を選ばず、
    十の位で選び、一の位では残った3つの数の中から1つを選ぶ事象の総数と考えると
    その組み合わせは4P1 * 4P1 * 1 * 3P1 = 48通り

    一の位も同様に考える。
    千の位では0,該当の数を除く数の中から選ぶので、4通り
    百,十の位の選び方は 4P2 = 12通り
    よって、一の位が該当の数になる組み合わせはそれぞれ48通り
    ```

## Q9 辞書式順列

??? success

    ### 例

    ```text
    a,b,c,d,eの5文字を1個ずつ使ってできる
    すべての文字列をアルファベット順に並べる

    [1] dbeacは何番目にあるか

    axxxxとなる数は全部で、4! = 24通り
    b,cも同様に24通りずつ存在する

    daxxxとなる数は全部で、3! = 6通り
    dbaxx, dbcxxとなる数は2! = 2通りずつ存在する
    dbeacは辞書順で言うとその次であるため

    24 + 48 + 6 + 2*2 + 1 = 83番目

    [2] 88番目は何か
    
    a,b,cが一文字目に来る数の総数は 3 * 4! = 72
    dが一文字目にきて、a,bが二文字目に来る下図の総数は 3! * 2 = 12
    ここまでで84番目

    dcabe: 85番目
    dcaeb: 86番目
    dcbae: 87番目
    ∴ dcbea: 88番目
    
    ----------------

    アルファベットをa = 1, b = 2, c = 3, d = 4, e = 5
    に置き変えて、{1,2,3,4,5}を並び替えたとき、42513が何番目に来るかという
    問題に帰着させることができる

    1xxxx, 2xxxx, 3xxxxはそれぞれ4!通り
    41xxxは3!通り
    421xx, 423xxはそれぞれ 2通り
    42513は次に来る

    よって、4!*3 + 3! + 2*2 + 1 = 83番目
    ```

## Q10 隣接する順列と隣接しない順列

??? success

    ### 考え方

    ```text
    隣接するもの：1組にまとめて全体を並べる. 次に組の内部を並べる

    隣接しないもの：それら以外のものを並べる. 次に両端、または間に入れる。
    ```

    ### 例

    ```text
    男子4人と女子3人を1列に並べる。次の並べ方は何通り存在するか


    [1] 女子3人が隣り合う

    女子3人をひと固まりで考え、5個の順列であると考える
    また、女子の並べ方は3!存在するので

    5! * 3! = 720通り

    ※5!の並べ方のいずれにおいても、3!の女子の並べ方が存在するので、積の法則が使える

    [2] 女子が隣り合わない

    男子4人の並べ方を考えると4!
    〇男〇男〇男〇男〇
    上記の〇の位置のいずれかに女子は並べられる

    
    5個の席のうち3つについて3人の女子を1対1対応させることができ、
    男子の並べ方のいずれにおいても、女子の並べ方が存在するため

    4! * 5P3 = 24 * 60 = 1440通り

    [3]　少なくとも2人の女子が隣り合う

    (少なくとも2人の女子が隣り合う) = (全体) - (女子が隣り合わない)であるため

    全体の場合の数を考えると
    7! =5040

    ∴ 5040 - 1440 = 3600通り

    [4] 女子3人のうち、2人だけが隣り合う

    (少なくとも2人の女子が隣り合う) - (女子3人が隣り合う) - 
    = (2人だけが隣り合う)であるため

    3600 - 720 = 2880通り

    ------------------------

    [4:別解]

    男子4人の並べ方は4! = 24通り

    〇男〇男〇男〇男〇
    男子の並べ方それぞれについて、
    両端と間を含めた5か所から1か所選んで、
    女子3人の名から2人を選び、女子2人をまとめて入れ
    4か所から1か所選んで、残った女子1人を入れると総数になる

    5*3P2 * 4 = 120

    ∴ 24*120 = 2880通り
    
    [5] 男子と女子が交互に並ぶ

    男子4人の並べ方は24通り

    〇男〇男〇男〇男〇

    交互に並ぶようにするには、男子の間にある3か所に対し、
    女子3人を1対1対応させる必要がある。
    ∴ 4! * 3! = 24*6 = 144通り

    [6] 少なくとも2人の男子が隣り合う
    (全体) - (男子が隣り合わない) = (少なくとも2人の男子が隣り合う)であるため

    (男子が隣り合わない)ケースの総数を考える
    女子の並び順の総数を考えると、3! = 6
    〇女〇女〇女〇
    女子の間と両端の4か所に対し、男子4人を1対1対応させる必要があるので
    3! * 4! = 144通り
    --> 交互に並ぶと同じ事象

    ∴5040 - 144 = 4896通り

    [7] 男子Xが女子2人と隣り合う
  
    男子Xと隣り合う女子の並び順は、3P2 = 6通りである
    それぞれについて、他の3人の男子と、選ばれなかった女子1人、
    女男女の組の並び方を考えると

    ∴ 5! * 6 = 720通り

    [8] 女子A,B,Cのうち、AがB,Cの少なくとも1人と隣り合う

    (全体) - (AがB,Cのいずれとも隣り合わない) = (AがB,Cの少なくとも1人と隣り合う)

    (AがB,Cのいずれとも隣り合わない) 
    = 女子3人が隣り合わない + (女子B,Cが隣り合い,Aとは隣り合わない)

    男子4人, 女子B,Cの組の並び順について考えると
    5! * 2 = 240
    〇(男)〇(男)〇(男)〇(男)〇(女子チーム)〇
    この時、女子チームと隣り合わないような女子Aの並べ方は
    それぞれの並べ方について4通り

    よって、240 * 4 = 960通り

    (AがB,Cのいずれとも隣り合わない)  = 1440 + 960 = 2400通り

    ∴(AがB,Cの少なくとも1人と隣り合う) = 5040 - 2400 = 2640通り

    ----------------------

    [8:別解]
    (AがB,Cの少なくとも1人と隣り合う)
    = AがBと隣り合う + AがCと隣り合う - xAxの形で3人の女子が並びあう
    = 6!*2 + 6!*2 - (720 / 3)
    = 2880 - 240
    = 2640通り
    --> 重複部分を考える。Aが真ん中に来ることに注意する

    [9] 女子A,B,Cのうち、AとBが隣り合い、BとCが隣り合わない

    男子4人, AとBの組の並び方を考えると5!
    また、ABの並び順を考慮に入れると、5! * 2
    
    〇男〇男〇男〇男〇AB〇
    
    それぞれについて、BとCが隣り合わないようにするには
    5箇所の中から1か所選ぶことになる
    
    ∴ 5! * 2 * 5 = 1200通り

    --------------------

    [9:別解]

    AとBが隣り合う並び方は 6! * 2 = 1440通り
    AとB, BとCが隣り合う並び方は、xBxの形になるため
    5!*2 = 240通り

    よって、AとBが隣り合い、BとCが隣り合わない並び方は
    1440 - 240 = 1200通り



    ```


## Q11 重複順列、部分集合の個数、部屋割り

??? success

    ### 重複順列

    ```text
    異なるn個のものから重複を許してr個とって並べる順列の総数は

    n^r

    積の法則を考えれば
    n通り*それぞれについてn通り*それぞれについて...なので当然

    同じものを何度でも取り出せるためn ≧ rの制約はない
    ```

    ### 例

    ```text
    4個の数字0,1,2,3から重複を許して選んでできる5桁以下の整数の個数を求めよ

    5桁の整数について
    3*4^4 = 3 * 256 = 768通り

    4桁の整数について
    3*4^3 = 192通り

    3桁の整数について
    3*4^2 = 48通り

    2桁の整数について
    3*4 = 12通り

    1桁の整数は0,1,2,3の4通り

    ∴ 768 + 192 + 48 + 12 + 4 = 256 + 768 = 1024個  

    ------------------

    [別解]
    最高位も含めてすべての桁に0,1,2,3を並べた場合
    数字の並べ方は4^5通り

    ここで、00001, 00012, 00134, 01234はそれぞれ1,2,3,4桁の整数に対応するため
    すべての桁数の整数について、4^5通りで表現できる

    4^5 = 2^10 = 1024通り
    ```

    ### 部分集合の個数

    ```text
    集合A = {1,2,3,4,5}の部分集合の個数を求めよ

    1が部分集合に属すかは2通り
    それぞれについて、他の元についても同様に考えられる

    ∴ 2^5 = 32個
    
    --------------

    1対1対応で考えるなら、1,2,3,4,5の位置に
    属す場合に〇、属さない場合に×が属すと考える
    すると、Aの部分集合と〇,×の並びが1対1対応する

    --> 内容まで答える必要はないのでこれで行ける
    ```

    ### 例

    ```text
    異なる4冊の本を3人に配る時、何通りの配り方があるか
    1冊ももらえない人がいてもよい

    各本の配り方は3通り

    よって、3^4 = 81通り
    ```

    ### 部屋割り

    ```text
    5人の生徒を次のように部屋割りする方法の場合の数を考えたい
    ただし空き部屋が出てはならない

    ※空き部屋のケースを後から引くのが肝

    -----------------

    [1] 2つの部屋A,Bに入れる

    1人目の人物の部屋の割り振りは2通り
    それぞれの場合について、2人目の割り振りが2通りと考えると
    空き部屋を意識しない部屋の割り振りは、2^5 = 32通り

    ここで、Aに5人, Bに5人割り振られるケースを考えると

    ∴ 32 - 2 = 30通り

    [2] 3つの部屋A,B,Cに入れる

    同様にして空き部屋を意識しない部屋の割り振りは3^5通り

    Aのみ, Bのみ, Cのみ, AとBのみ, AとCのみ, BとCのみに割り振られるケースを考える
    必要がある。これらのケースは互いに排反である。

    Aのみ, Bのみ, Cのみは合わせて3通り

    [1]より、2つの部屋に割り振られる総数は、30通りであるため
    AとBのみ, AとCのみ, BとCのみは合わせて90通り

    ∴ 3^5 - 3 - 90 = 243 - 93 = 150通り

    ※以下の問題文と同様
      3文字A,B,Cから重複を許して5個選んで並べるとき、A,B,Cをすべて含む並べ方
      1つ目がA,B,Cのいずれかに対応して
      ...であるため。
    ```

