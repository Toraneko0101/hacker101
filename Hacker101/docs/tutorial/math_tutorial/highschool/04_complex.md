# 04_複素数

## Q4 複素数関連の語句について知っていますか?

??? success
    ### 複素数

    ```text
    複素平面（ガウス平面）
      ・複素数z = x + yiを直交座標(x,y)に対応させた直交座標平面
      ・複素数の実部がx成分、虚部がy成分に対応する
    
    極座標
      ・原点からの距離rと、角度Θを用いて
        平面上の点の座標を表す方法
      
      ※直交座標が(x,y)で点の位置を表すのに対し
        極座標は(r,Θ)で点の位置を表す
      
      ・r: 原点からの距離を指し、「動径」と呼ばれる
      ・Θ: 始線(原点を通る半直線。通常x軸の正の向きに一致)から
           反時計回りに測った角度。「偏角」と呼ばれる
      
      ・距離と角度を用いて表現するため、物理現象の記述に便利
      ・回転や拡大を複素数の掛け算で容易に表現可能
    
    直交座標と極座標の変換
      ・直交座標で(x,y), 極座標で(r,Θ)で表される点Aを考える
        この時、図を書けば自ずとx = rcosΘ, y = sinΘとわかる
      
      例)  (r,Θ) = (2,π/6)の場合、直交座標(x,y)は
          x = 2cosπ/6 = √3,  y = 2sinπ/6 = 1 
          (x,y) = (√3, 1)
    
    複素数の極座標表現
      ・z = x + yi = rcosΘ + risinΘ = r(cosΘ + isinΘ)

      ・r = |a + bi| = √(a^2 + b^2) ※rは原点からの距離なので

      例) z = √3 + iを極形式で表す
          r = |z| = √(√3^2 + 1^2) = 2
          直交座標における座標は(√3, 1)であるため偏角はπ/6
            --> cosΘ = √3/2, sinΘ = 1/2
          よって、z = 2(cosπ/6 + isinπ/6)

    複素数の演算
      ・加算減算では実部同士、虚部同士で演算を行う
      ・乗算ではi^2になったら-1に変換する
      ・除算では有理化を行うことで、分母に複素数を含まない形に変換することが多い
      ・(a+bi)±(c+di) = (a±c) + (b±d)i
      ・(a+bi)(c+di) = ac + (ad + bc)i - bd
    
    共役な複素数
      ・a + biにたいして、a - biのような複素数
      ・共役な複素数は、複素数をzとすると、\bar{z}のように表記されることが多い
      ・複素平面でいうと、実軸に対して対称移動したものに相当する

      ・zが実数 ⇔ z = \bar{z}
      ・zが純虚数 ⇔ z = -\bar{z}かつ、z≠0となる(z=0なら、0で実数になるので)
    
    ド・モアブルの定理
      ・整数nと、任意の実数Θに対して(cosΘ + isinΘ)^n = cosnΘ + isinnΘ
      ・rを両辺に乗算すれば、絶対値が1でない一般の複素数に対しても用いることができる
        {r(cosΘ + isinΘ)}^n = r(cosnΘ + isinnΘ)
      
      ・「絶対値が1の複素数のn乗は、偏角のn倍」であることを意味する
      
      使用例)
        x^3 = 1の根について考える。xを複素数r(cosΘ + isinΘ)で表すと
        (複素数は、乗算について閉じているので、3乗した結果もまた複素数)
        x^3 = r(cosΘ + isinΘ)^3 = r(cos3Θ + isin3Θ) = 1
        x^3の絶対値について、左辺より|1+0i| = √(1^2 + 0) = 1なので、r = 1
        右辺の実部が1, 虚部が0であることから、以下の通りになるΘを求める問題に帰結する
        cos3Θ = 1, sin3Θ = 0
        この時、Θの範囲を0≦Θ≦2πとすると
        Θ = 0, 2π/3, 4π/3となる。したがって、x^3=1の根は

        x = cos0 + isin0 = 1
        x = cos2π/3 + isin2π/3 = -1/2 + (√3/2)i
        x = cos4π/3 + isin4π/3 = -1/2 - (√3/2)i
    ```

    ### 複素数の四則演算の意味合い

    ```text
    足し算
      ・直交座標で考えると、複素平面上でのベクトルの足し算(合成)を意味する
    
    引き算
      ・180度回転させた、ベクトルの足し算と考えればいい
    
    掛け算
      ・極形式で考えると、動径(r >=0)同士はかける。偏角同士は足す
      --> r1r2{cos(Θ_1 + Θ_2) + isin(Θ_1 + Θ_2)}

      ※導出
      z1 = r1(cosΘ_1 + isinΘ_1)
      z2 = r2(cosΘ_2 + isinΘ_2)
      z1z2 = r1r2(cosΘ_1 + isinΘ_1)(cosΘ_2 + isinΘ_2)
      = r1r2(cosΘ_1cosΘ_2 - sinΘ_1sinΘ_2) + r1r2i(sinΘ_1cosΘ_2+ cosΘ_1sinΘ_2)
      = r1r2cos(Θ_1 + Θ_2) + r1r2isin(Θ_1 + sinΘ_2)
      = r1r2{cos(Θ_1 + Θ_2) + isin(Θ_1 + Θ_2)}
    
    割り算
      ・極形式で考えると、動径同士は割る、偏角同士は引く
    
    ※ある複素平面上の点Zをr_1倍してΘ_1だけ回転させたければ
      r_1(cosΘ_1 + isinΘ_1)をかければいい
    ```

    ### 複素平面での垂直・平行

    ```text
    複素平面上の相異なる4点 A(α), B(β), C(γ),D(δ)について考えるとき
    ABとCDが平行 ⇔ (α-β)/(γ-δ)が実数
    ABとCDが垂直 ⇔ (α-β)/(γ-δ)が純虚数

    ※ベクトルと対応させて考えるとわかりやすい

    [垂直について]
    複素数z = r(cosΘ + isinΘ)は、re^{iΘ}とも表せる
    ※オイラーの公式：e^{iz} = cosz + isinz
    複素数同士の除算について考えると、
    (α-β = z1, γ-δ=z2とおく)
    複素数の大きさ(絶対値:r)は割られ、偏角はその差となるため
    z1/z2 = (|z1|/|z2|)e^{i(Θ_1 - Θ_2)}
    
    ここで、複素平面上で「垂直であるとき、Θ_1 - Θ_2 = π/2, 3/2π」と考えられるため
    z1/z2 = (|z1|/|z2|)e^{iπ/2}
    e^{i(π/2)}についてはオイラーの公式より
    e^{i(π/2)} = cosπ/2 + isinπ/2 = iとわかるので、

    z1/z2 = i(|z1|/|z2|)となる。
    ※3/2πと考えても、-i(|z1|/|z2|)で純虚数倍になる
    よって、(α-β)/(γ-δ)は純虚数

    [平行について]
    z1/z2 = (|z1|/|z2|)e^{i(Θ_1 - Θ_2)}
    平行であるとき、Θ_1 - Θ_2 = 0 or π
    いずれにしても、オイラーの公式を用いれば
    e^{i0} = 1 , e^{iπ} = -1になるため、
    z1/z2 = (|z1|/|z2|) または
    z1/z2 = -(|z1|/|z2|)
    よって、複素数の比は絶対値の除算あるいは、除算後に符号反転をしたものとなる
    そのため、実数倍になる

    逆に辿れば、実数倍、純虚数倍であるとき、Θがそれぞれ平行、垂直を意味する
    値になることもわかり、⇔だといえる
    
    ```

    ### 共役な複素数の性質

    ```text
    共役な四則演算
      ・任意の複素数z,wについて考えると以下が成り立つ
      ・つまり、共役と四則演算の順番は交換可能
    ```

    $$
      \begin{align}
        \overline{z+w} = \overline{z} + \overline{w} \\
        \overline{z-w} = \overline{z} - \overline{w} \\
        \overline{z\times w} = \overline{z} \times \overline{w} \\
        \overline{z\div w} = \overline{z} \div \overline{w}(ただし、w \neq 0) \\
      \end{align}
    $$

    ```text
    共役な複素数と絶対値
      ・有理化を考えればわかるが
        任意の複素数z = a + bi に対して、z\bar{z}は0以上の実数

      例 (2+2i)(2-2i) = 2^2 + 4 = 8

      ・任意の実数a,bに対して、a+biとa-biの積は(a+bi)(a-bi)=a^2 + b^2 >=0
        複素平面を考えると√(a^2 + b^2)が、z = a + biの絶対値|z|であるため、
        以下のように書き直せる
    ```

    $$
      z\bar{z} = |z|^2
    $$

    ### 実数係数多項式と複素数

    ```text
    ・実数係数多項式 = 0という方程式に対して、zが解ならば、
    　\bar{z}(zの共役な複素数)も解である

    例) ax^2 + bx + c = 0において、複素数A + Biが解ならば、A - Biも解
        (a,b,c,A,Bは実数)
    
    例) 実数係数の3次方程式について考える
        この時、p + qiが解ならば、p - qiは解
        つまり、実数係数の3次方程式は3つの解がすべて実数解か
        p + qi, p - qi, r(ただし、p,q,rは実数)と表せる
    ```

    $$
      \begin{align}
        & [証明] \\
        & 実数係数のn次方程式\displaystyle\sum_{k=0}^{n}a_kx^{k} = 0に対して、
          zが解の時 \\
        & \displaystyle\sum_{k=0}^{n}a_kz^{k} = 0 \\
        & 両辺に対して共役をとると(補足3) \\
        & \displaystyle\overline{\sum_{k=0}^{n}a_kz^{k}} = 0 \\
        & 共役と四則演算の順番は交換可能なので \\
        & \displaystyle\sum_{k=0}^{n}\overline{a_kz^{k}} = 0 \\
        & \displaystyle\sum_{k=0}^{n}\overline{a_k}\,\,\overline{z}^{k} = 0 \\
        & 実数係数の方程式なのでa_kは実数。\\
        & よって\quad\overline{a_k} = a_k とすると\\
        & \displaystyle\sum_{k=0}^{n}a_k\overline{z}^{k} = 0 \\
        & よってzが解なら、\overline{z}は方程式の解 \\
      \end{align}
    $$

    ### 複素数と√

    ```text
    ・二乗して複素数になる複素数について考える

    [iのルートを求める:連立方程式]
      z^2 = (a+bi)^2 = i
      a^2 - b^2 +2abi = i
      実部と虚部を比較すると
      a^2 - b^2 = 0,  2abi = i
      ab = 1/2 (a+b)(a-b) = 0
      (a,b) = (1/√2, 1/√2), (-1/√2, -1/√2)
      よって、iのルートは、
      ±(1/√2)(1+i)
    
    [iのルートを求める: 複素平面]
    ・複素平面上で動径がr, 偏角がΘである点zを(r,Θ)と表す
      ここで、z = r(cosΘ + isinΘ) = re^{iΘ}
    
    ・複素数同士の掛け算は、絶対値は乗算し、偏角は加算する
      そのため自乗を行って(r,Θ)になるような数は(0<=Θ<=2πの範囲で)
      (√r, Θ/2), (√r, π + Θ/2)となる (2πで一周するため)
    
      実際に、z_1 = {√r(cosΘ/2 + isinΘ/2)}^2 = r(cosΘ + isinΘ)
      z_2 = {√r(cos(π + Θ/2) + isin(π + Θ/2))}^2= r(cosΘ + isinΘ)

      -------

      複素平面上で考えるとiは動径1, 偏角がπ/2である
      よって二乗してiになる数は
      z_1 = 1*(cosπ/4 + isinπ/4)
          = (1/√2)(1 + i)
      
      z_2 = 1*(cos(5π/4) + isin(5π/4))
      = -(1/√2)(1 + i)

      この時、z_1を、複素数の平方根の主値という
    ```

    ### 複素数と絶対値

    ```text
    ・複素数z = a + biの絶対値|z|を
    　|z| = √(a^2 + b^2)で定義する

    ・この定義は実数の場合(b = 0の場合)、|z| = |a|となることを意味し
      実数の絶対値の定義と合致する。
    
    ・複素平面で言うと、原点からの距離を意味する

    ※以下、z,wは任意の複素数とする
    ※a,b,c,dは任意の実数とする

    [絶対値の非負性]
      ・|z| >= 0　(√(a^2 + b^2) >=0より)
      ・|z| = 0 ⇔ z = 0  (√(a^2 + b^2) = 0 ⇔ a = 0, b = 0より)

    [絶対値の積※証明1]
      |zw| = |z||w|
    [絶対値の商※証明2]
      |z/w| = |z|/|w| (ただし、w≠0)
    [三角不等式※証明3]
      |z+w| <= |z| + |w|　
      |z-w| >= |z| - |w|　
      |z+w| >= |z| - |w|
    [共役と絶対値]
      ・|z| = |zの共役| (√(a^2 + b^2) = √(a^2 + (-b)^2)より)
      ・z * zの共役 = |z|^2  ((a+bi)(a-bi) = a^2 + b^2 = √(a^2 + b^2)^2より)
    ```

    $$
      \begin{align}
        & [証明1: 絶対値の積] \\
        & |zw|\\
        & = |(a+bi)(c+di)|\\
        & = |(ac - bd) + (ad + bc)i|\\
        & = \sqrt{(ac - bd)^2 + (ad + bc)^2}\\
        & \\
        & |z||w|\\
        & = |(a+bi)||c + di|\\
        & = \sqrt{a^2 + b^2}\sqrt{c^2 + d^2}\\
        & = \sqrt{(a^2 + b^2)(c^2 + d^2)}\\
        & より、|zw| = |z||w|というためには、両辺を2乗して\\
        & (ac-bd)^2 + (ad + bc)^2 = (a^2 + b^2)(c^2 + d^2)が示せればいい \\
        & ここで、上記はブラーマグプタの二平方恒等式の形である。\\
        & もしくは右辺を展開すれば、上記の等式が真であることは確かめられる \\
        & \\
        & [証明2: 絶対値の商] \\
        & 証明1より、|zw| = |z||w| \\
        & ここで、w = \frac{1}{v}とおくと(vは複素数) \\
        & |z||w| =  |z|\left|\frac{1}{v}\right| = |z|\frac{1}{|v|} = \frac{|z|*1}{|v|} = \frac{|z|}{|v|}(ただしv \neq 0) \\
        & |zw| = \left|z*\frac{1}{v}\right| = \left|\frac{z}{v}\right|(ただしv \neq 0) \\
        & \\
        & [補足]\left|\frac{1}{v}\right| = \frac{1}{|v|}について \\
        & vを任意の複素数とすると v = a + biで、|v| = \sqrt{a^2 + b^2} \\
        & よって、逆数\frac{1}{v} = \frac{1}{a + bi} = \frac{a - bi}{a^2 + b^2} = \frac{a}{a^2 + b^2} + \frac{-b}{a^2 + b^2}i \\
        & ここで、複素数\frac{1}{v}の絶対値を求めると \\
        & \left|\frac{1}{v}\right| = \sqrt{(\frac{a}{a^2 + b^2})^2 + (\frac{-b}{a^2 + b^2})^2} \\
        & = \sqrt{\frac{a^2 + b^2}{(a^2 + b^2)^2}} = \frac{\sqrt{a^2 + b^2}}{a^2 + b^2} \\
        & ここで、\sqrt{a^2 + b^2} = |v|なので、 \\
        & = \frac{|v|}{|v|^2} \\
        & 分母と分子をそれぞれ、|v|で割ると(斉一性：除法性, v \neq 0)、 \\
        & = \frac{1}{|v|} \\
        & よって、\left|\frac{1}{v}\right| = \frac{1}{|v|} \\
        & \\
        & [証明3: 三角不等式] \\
        & 任意の複素数z_1,z_2に対して、|z_1 + z_2| \le |z_1| + |z_2|であることを証明する \\
        & z_1 = a_1 + b_1i, \quad z_2 = a_2 + b_2iとおく \\
        & この時、左辺は \\
        & |z_1 + z_2 | = \sqrt{(a_1 + a_2)^2 + (b_1 + b_2)^2} \\
        & 右辺は \\
        & |z_1| + |z_2| = \sqrt{a_1^2 + b_1^2} + \sqrt{a_2^2 + b_2^2} \\
        & \\
        & ここで、|z_1 + z_2|,|z_1|+|z_2|は絶対値の定義より非負なので \\
        & |z_1 + z_2|^2 \le (|z_1| + |z_2|)^2 \Rightarrow |z_1 + z_2| \le |z_1| + |z_2|...(1)といえる \\
        & 左辺を二乗すると \\
        & (左辺) = (a_1 + a_2)^2 + (b_1 + b_2)^2 = a_1^2 + b_1^2 + a_2^2 + b_2^2 + 2(a_1a_2 + b_1b_2)\\
        & 右辺を二乗すると \\
        & (右辺) = a_1^2 + b_1^2 + a_2^2 + b_2^2 + 2\sqrt{(a_1^2 + b_1^2)(a_2^2 + b_2^2)} \\
        & 左辺と右辺をそれぞれ2で割ると以下のようになり、以下を証明する問題へと帰着する \\
        & a_1a_2 + b_1b_2 \le \sqrt{(a_1^2 + b_1^2)(a_2^2 + b_2^2)} ...(2)\\
        & ここで(2)はコーシーシュワルツの不等式より成立する \\
        & よって、|z_1 + z_2|^2 \le (|z_1| + |z_2|)^2 \\
        & (1),(2)より、|z_1 + z_2| \le |z_1| + |z_2| ...(3)\\
        & \\
        & (3)より、z_1 = z-w, z_2 = wとおくと、|z| = |(z-w) + w| \le |z-w| + |w| \\
        & 式変形して、|z| - |w| \le |z-w| ...(4)\\
        & \\
        & |z| < |w|の時、|z| - |w|は負になるため、 |z| - |w| \le |z+w| \\
        & |z| \ge |w|の時、|z-w|,|z| - |w|は非負なので \\
        & (|z| - |w|)^2 \le |z+w|^2 \Rightarrow |z|-|w| \le |z+w|...(5)といえる \\
        & z = a_1 + b_1i, w = a_2 + b_2iとおいて、両辺を2乗すると \\
        & (左辺) = a_1^2 + b_1^2 + a_2^2 + b_2^2 - 2\sqrt{(a_1^2 + b_1^2)(a_2^2 + b_2^2)} \\
        & (右辺) = (a_1 + a_2)^2 + (b_1 + b_2)^2 = a_1^2 + b_1^2 + a_2^2 + b_2^2 + 2(a_1a_2 + b_1b_2) \\
        & ここで、左辺 - 右辺 \le 0となればいいため、以下を証明する問題へと帰着する \\
        & - (\sqrt{(a_1^2 + b_1^2)(a_2^2 + b_2^2)} + (a_1a_2 + b_1b_2))\le 0 \\
        & ここで\sqrt{(a_1^2 + b_1^2)(a_2^2 + b_2^2)}は非負であるため \\
        & a_1a_2 + b_1b_2 \le \sqrt{(a_1^2 + b_1^2)(a_2^2 + b_2^2)} であればよい \\
        & (2)はコーシーシュワルツの不等式より成立するため、|z|-|w| \le |z+w| \\
        & \\
      \end{align}
    $$

    ### 補足1(根と解)

    ```text
    ・根は重複した解を区別する
    ・つまり、(x-1)^2の根は、1と1
    ```

    ### 補足2(ド・モアブルの定理の証明)

    ```text
    1 まず、n>=0について成り立つことを数学的機能を用いて証明する

    [i] n = 0の時、
    (左辺) (cosΘ + isinΘ)^0 = 1 (0乗なので)
    (右辺) (cos0Θ + isin0Θ) = 1
    よって、n = 0の時、本定理は成立する

    [ii] n - 1の時、すなわち
    (cosΘ + isinΘ)^{n-1} = cos(n-1)Θ + isin(n-1)Θが成り立つと仮定すると

    (cosΘ + isinΘ)^n = (cosΘ + isinΘ)^{n-1}(cosΘ + isinΘ)
    = {cos(n-1)Θ + isin(n-1)Θ}(cosΘ + isinΘ)
    = cos(n-1)ΘcosΘ + icos(n-1)ΘsinΘ + isin(n-1)ΘcosΘ - sin(n-1)ΘsinΘ

    加法定理を用いると
    cos(n-1)ΘcosΘ - sin(n-1)ΘsinΘ = cos(n-1 + 1)Θ = cosnΘ
    icos(n-1)ΘsinΘ + isin(n-1)ΘcosΘ
    = i{sin(n-1)ΘcosΘ + cos(n-1)ΘsinΘ}
    = isinnΘ

    よって、cosnΘ + isinnΘ
    ゆえに、nの時も本定理は成立する。

    従って[i],[ii]より、数学的帰納法によってn >=0に対して本定理が成立する。

    2 
    次にn < 0の場合について、1を利用して証明する
    n < 0の時、n = -mと置くと、mは自然数である
    1の結果より、m(自然数)については本定理が成立するため
    (cosΘ + isinΘ)^n = (cosΘ + isinΘ)^{-m}
    = 1/(cosΘ + isinΘ)^m
    = 1/ (cosmΘ + isinmΘ)
    = (cosmΘ - isinmΘ)/(cosmΘ + isinmΘ)(cosmΘ - isinmΘ)
    = (cosmΘ - isinmΘ)/ cos^2mΘ + sin^2mΘ
    = cosmΘ - isinmΘ
    三角函数の負角の公式を利用すると
    = cos(-m)Θ + isin(-m)Θ
    = cosnΘ + isinnΘ

    ゆえに、n < 0の時も、本定理が成立する
    従って、1,2より任意の整数nに対して、本定理が成立する□
    ```

    ### 補足3(複素数の両辺の共役をとるという操作について)

    $$
      \begin{align}
        & 任意の複素数z_1について、反射律によりz_1 = z_1 \\
        & 共役\overline{z_1}についても、反射律より、\overline{z_1} = \overline{z_1} \\
        & ここで、任意の複素数z_1,z_2についてz_1 = z_2が成り立つ場合、\\
        & 代入原理により任意の命題P(x)に対して P(z_1) \Leftrightarrow P(z_2) \\
        & ここで、命題P(x)をP(x) = (\overline{x} = \overline{z_2})と定義する \\
        & すなわちz_1 = z_2 ⇒ (\overline{z_1} = \overline{z_2}) \Leftrightarrow (\overline{z_2} = \overline{z_2}) \\
        & (\overline{z_2} = \overline{z_2})は、反射律より恒真なので、前提z_1 = z_2ならば、(\overline{z_1} = \overline{z_2}) \\
        & z_1, z_2ともに定数であるため、代入原理が使える \\
      \end{align}
    $$

    ### 補足4(複素数の両辺を自乗するという操作について)

    $$
      \begin{align}
      & 任意の複素数z_1, z_2について、反射律によりz_1 = z_1, z_2 = z_2 \\
      & また、a = (z_2)^2とすると、同様に反射律(a=a)により、(z_2)^2 = (z_2)^2 \\
      & z_1 = z_2が成り立つ場合、代入原理により任意の命題P(x)に対し、P(z_1) \Leftrightarrow P(z_2) \\
      & ここで、命題P(x)をP(x) = (x^2 = (z_2)^2)と定義する \\
      & すなわち、z_1 = z_2 \Rightarrow ((z_1)^2 = (z_2)^2) \Leftrightarrow ((z_2)^2 = (z_2)^2) \\
      & (z_2)^2 = (z_2)^2は反射律より恒真なので、前提z_1 = z_2ならば、(z_1)^2 = (z_2)^2 \\
      & [さらに補足]：平方根に対しても、P(x) = (\sqrt{x} = \sqrt{z_2})のようにすることでいける \\
      \end{align}
    $$

    ### 補足5(ブラーマグプタの二平方恒等式)

    ```text
    ・二つの平方数の和で表される二つの数の積(a^2 + b^2)(c^2 + d^2)が
      二つの平方数の和(ac - bd)^2 + (ad + bc)^2 or (ac+bd)^2 + (ad - bc)^2
      で表せることを示す恒等式
    
    (a^2 + b^2)(c^2 + d^2)
    = (ac - bd)^2 + (ad + bc)^2 
    = (ac+bd)^2 + (ad - bc)^2

    例) a = 38, b = 12, c = 21, d = 23
    (a^2 + b^2)(c^2 + d^2) = (1444 + 144)(441 + 529) = 1588*970 = 1540360
    (ac - bd)^2 + (ad + bc)^2 = (798 - 276)^2 + (874 + 252)^2
    = 272484 + 1267876 = 1540360
    
    [平方数]
      ・整数の自乗で表される数
    ```

    ### 補足6(和の形のコーシーシュワルツの不等式:内積空間のじゃないよ)

    $$
      \begin{align}
      & 任意の実数a_i, b_iに対し、以下の不等式が成立する \\
      & (a_1^2 + a_2^2)(b_1^2 + b_2^2) \ge (a_1b_1 + a_2b_2)^2 \\
      & (a_1^2 + a_2^2 + a_3^2)(b_1^2 + b_2^2 + b_3^2) \ge (a_1b_1 + a_2b_2 + a_3b_3)^2 \\
      & \\
      & 一般に、a_1,...,a_n,b_1,...,b_n \in \mathbb{R}に対して、以下の不等式が成立する \\
      & \displaystyle\left(\sum_{i=1}^n a_i^2\right)\left(\sum_{i=1}^n b_i^2\right) \ge \left(\sum_{i=1}^n a_ib_i \right)^2 \\
      & \\
      & [証明] \\
      & 2次方程式\sum_{i=1}^{n}(a_ix - bi)^2 = 0について考える \\
      & この時、式の左辺は0以上であることから、座標平面で考えると、2点以上で交わることはなく \\
      & 方程式の実数解は多くとも1つになる \\
      & つまり、この式の判別式\frac{D}{4}は \frac{D}{4}\le 0 \\
      & ここで実際に左辺を計算すると \\
      & \sum_{i=1}^{n}(a_ix - bi)^2 = \left(\sum_{i=1}^{n}a_i^2\right)x^2 -2\left(\sum_{i=1}^{n} a_ib_i\right)x + \left(\sum_{i=1}^{n}b_i^2\right) \\
      & この時、判別式\frac{D}{4}は、\\
      & \frac{D}{4} = \left(\sum_{i=1}^{n} a_ib_i\right)^2 - \left(\sum_{i=1}^{n}a_i^2\right)\left(\sum_{i=1}^{n}b_i^2\right) \\
      & 判別式\frac{D}{4}は0以下であることから、\\
      & \left(\sum_{i=1}^{n} a_ib_i\right)^2 - \left(\sum_{i=1}^{n}a_i^2\right)\left(\sum_{i=1}^{n}b_i^2\right) \le 0 \\
      & 移行すると、\\
      &  \left(\sum_{i=1}^{n} a_ib_i\right)^2 \le \left(\sum_{i=1}^{n}a_i^2\right)\left(\sum_{i=1}^{n}b_i^2\right) \\
      & [補足：等号成立条件] \\
      & 判別式\frac{D}{4}が0になる時、等号は成立する \\
      & つまり、i = 1,...,nに対して、a_ix = b_iとなる解xが存在する必要があるが \\
      & 特に各a_i \neq 0の場合については、\frac{b_1}{a_1}=...=\frac{b_n}{a_n}と表せる \\
      & [補足1] \\
      & ※今回の場合(三角不等式で用いたのは)、n=2の不等式の両辺に根号をつけたものになる \\
      & 平方根函数f(x) = \sqrt{x}は、定義域x \ge 0 において単調増加であるため以下が成り立つ \\
      &  |a_1a_2 + b_1b_2| \le \sqrt{(a_1^2 + b_1^2)(a_2^2 + b_2^2)} \\
      & ※a_1a_2 + b_1b_2については、左辺が\ge 0であることから、\\
      & \quad a_1a_2 + b_1b_2が\ge 0の時も、< 0の時も上式は成り立つ　\\
      & よって、a_1a_2 + b_1b_2 \le \sqrt{(a_1^2 + b_1^2)(a_2^2 + b_2^2)}は恒真 \\
      & [補足2] \\
      & 単調増加(引数の値が大きくなるにつれ、常にf(x)が大きくなるような函数:ただし引数の値は実数) \\
      \end{align}
    $$

    ```text
    ```